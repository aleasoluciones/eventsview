<html>

<body>


<div>
    <ul id="warningsul">
    </ul>
</div>
<hr>
<div>
    <ul id="eventsul">
    </ul>
</div>



<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script type="text/javascript" src="./events.js"></script>
<script type="text/javascript">
(function() {

    function renderNewEvents(events){
        events.sort(function(e1, e2) { return e2.id - e1.id; });
        var eventsul = $("#eventsul");
        eventsul.empty();

        for (var i=0; i< events.length; i++){
            var liNode = $('<li>', {id: events[i].id});
            liNode.text(events[i].id + " " + events[i].timestamp +  " " + events[i].message);
            eventsul.append(liNode);
        }
    }

    function renderNewWarningEvents(warnings){
        warnings.sort(function(e1, e2) { return e2.id - e1.id; });
        var warningsul = $("#warningsul");
        warningsul.empty();

        for (var i=0; i< warnings.length; i++){
            var liNode = $('<li>');
            var href = $('<a>', {href: "#"+warnings[i].id});
            href.text(warnings[i].id + " " + warnings[i].message);
            liNode.append(href);
            warningsul.append(liNode);
        }
    }

    var eventsRepo = EVENTS.createAjaxRepository('/events');
    var eventsPresenter = EVENTS.createPresenter(
        eventsRepo,
        {render: renderNewEvents},
        {render: renderNewWarningEvents});
    eventsPresenter.displayEvents();
})();
</script>

</body>
</html>
